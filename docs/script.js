(()=>{const e="config",t=document.querySelector("dialog"),n=t.querySelector("input");t.getElementsByClassName("suggestions")[0].addEventListener("click",(e=>n.value=e.target.text)),t.querySelector("button[type=reset]").addEventListener("click",(()=>t.close())),t.querySelector("button[type=submit]").addEventListener("click",(()=>{const o=n.value.split(/\s+/).reduce(((e,t)=>{let n=parseFloat(t);if(!isNaN(n)){(t.includes("k")||t.includes("ะบ"))&&(n*=1e3);const o=n>1e3?n/1e3+" kHz":`${n} Hz`;e.push([o,n])}return e}),[]);d(o),t.close(),localStorage.setItem(e,JSON.stringify(o))}));const o=document.getElementById("sliders"),s={connect:"lower",direction:"rtl",orientation:"vertical",pips:{mode:"steps",density:2},range:{min:-12,max:12},start:0,step:1,tooltips:!0};let a,c,i,r=-1,l=!1;function d(e){o.innerHTML="",a=[],c=[],i=new Array(e.length),e.forEach((([e,t],n)=>{const d=document.createElement("div");d.className="band",d.dataset.title=e,d.dataset.value=t,o.appendChild(d);const u=noUiSlider.create(d,s);u.on("update",(([e])=>{const t=Math.pow(10,(e-12)/20);i[n]=t,r===n&&(p.gain.value=t)})),a.push(u);const v=u.target.getElementsByClassName("noUi-handle")[0];v.addEventListener("focus",(()=>{l||(g.start(),l=!0),g.frequency.value=d.dataset.value,p.gain.value=i[n],r=n})),v.addEventListener("touchend",(function(){this.focus()})),v.addEventListener("blur",(()=>{m()})),c.push(v)}))}const u=new(window.AudioContext||window.webkitAudioContext),g=u.createOscillator(),p=u.createGain();function m(){p.gain.value=0,r=-1}g.connect(p),p.connect(u.destination),document.getElementById("configure").addEventListener("click",(()=>{m(),t.showModal()})),document.getElementById("reset").addEventListener("click",(()=>{m(),a.forEach((e=>e.reset()))})),window.addEventListener("keydown",(e=>{"Escape"===e.key?c[r].blur():"ArrowRight"===e.key?(e.stopPropagation(),r<a.length-1&&(r++,c[r].focus())):"ArrowLeft"===e.key&&(e.stopPropagation(),r>0&&(r--,c[r].focus()))}),{capture:!0});const v=localStorage.getItem(e);v?d(JSON.parse(v)):t.showModal()})();
