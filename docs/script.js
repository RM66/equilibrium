(()=>{const e=document.querySelector("dialog"),t=e.querySelector("input");e.getElementsByClassName("suggestions")[0].addEventListener("click",(e=>t.value=e.target.text)),e.querySelector("button[type=reset]").addEventListener("click",(()=>e.close())),e.querySelector("button[type=submit]").addEventListener("click",(()=>{var d,g;g=t.value,d=g.split(/\s+/).reduce(((e,t)=>{let n=parseFloat(t);if(!isNaN(n)){(t.includes("k")||t.includes("ะบ"))&&(n*=1e3);const o=n>1e3?n/1e3+" kHz":`${n} Hz`;e.push([o,n])}return e}),[]),n.innerHTML="",a=[],s=[],i=new Array(d.length),d.forEach((([e,t],d)=>{const g=document.createElement("div");g.className="band",g.dataset.title=e,g.dataset.value=t,n.appendChild(g);const v=noUiSlider.create(g,o);v.on("update",(([e])=>{const t=Math.pow(10,(e-12)/20);u.gain.value=i[d]=t})),a.push(v);const m=v.target.getElementsByClassName("noUi-handle")[0];m.addEventListener("focus",(()=>{r||(l.start(),r=!0),l.frequency.value=g.dataset.value,u.gain.value=i[d],c=d})),m.addEventListener("touchend",(function(){this.focus()})),m.addEventListener("blur",(()=>{p()})),s.push(m)})),e.close()}));const n=document.getElementById("sliders"),o={connect:"lower",direction:"rtl",orientation:"vertical",pips:{mode:"steps",density:2},range:{min:-12,max:12},start:0,step:1,tooltips:!0};let a,s,i,c=-1,r=!1;const d=new(window.AudioContext||window.webkitAudioContext),l=d.createOscillator(),u=d.createGain();function p(){u.gain.value=0,c=-1}l.connect(u),u.connect(d.destination),document.getElementById("configure").addEventListener("click",(()=>{p(),e.showModal()})),document.getElementById("reset").addEventListener("click",(()=>{p(),a.forEach((e=>e.reset()))})),window.addEventListener("keydown",(e=>{"Escape"===e.key?s[c].blur():"ArrowRight"===e.key?(e.stopPropagation(),c<a.length-1&&(c++,s[c].focus())):"ArrowLeft"===e.key&&(e.stopPropagation(),c>0&&(c--,s[c].focus()))}),{capture:!0}),e.showModal()})();
